"use strict";(self.webpackChunkbrooder=self.webpackChunkbrooder||[]).push([[1535],{7519:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"workflows/shared/wallets","title":"Wallet Management","description":"This workflow describes how a user, either a Customer or a Provider, can retrieve their wallet balance and other related financial metrics. A user\'s wallet balance is modified by Transactions and can be paid out via Withdrawal Requests.","source":"@site/docs/workflows/shared/wallets.md","sourceDirName":"workflows/shared","slug":"/workflows/shared/wallets","permalink":"/brooder-doc/docs/workflows/shared/wallets","draft":false,"unlisted":false,"editUrl":"https://github.com/khalidgxg/brooder/tree/main/docs/workflows/shared/wallets.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Transaction History","permalink":"/brooder-doc/docs/workflows/shared/transactions"},"next":{"title":"Withdrawal Requests","permalink":"/brooder-doc/docs/workflows/shared/withdrawal-requests"}}');var n=r(4848),l=r(8453);const i={sidebar_position:2},o="Wallet Management",a={},d=[{value:"Endpoint",id:"endpoint",level:2},{value:"Get Wallet Details",id:"get-wallet-details",level:3},{value:"Process Flow",id:"process-flow",level:2},{value:"Response Body",id:"response-body",level:2},{value:"Success Response (<code>200 OK</code>)",id:"success-response-200-ok",level:3},{value:"Code Highlights &amp; Key Concepts",id:"code-highlights--key-concepts",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"wallet-management",children:"Wallet Management"})}),"\n",(0,n.jsxs)(t.p,{children:["This workflow describes how a user, either a Customer or a Provider, can retrieve their wallet balance and other related financial metrics. A user's wallet balance is modified by ",(0,n.jsx)(t.a,{href:"./transactions",children:"Transactions"})," and can be paid out via ",(0,n.jsx)(t.a,{href:"./withdrawal-requests",children:"Withdrawal Requests"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"endpoint",children:"Endpoint"}),"\n",(0,n.jsx)(t.h3,{id:"get-wallet-details",children:"Get Wallet Details"}),"\n",(0,n.jsx)(t.p,{children:"This endpoint provides a summary of the user's wallet, including available balance, pending amounts, and pending withdrawal requests."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Endpoint:"})," ",(0,n.jsx)(t.code,{children:"GET /api/v1/wallets"})]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Authorization:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Bearer Token (Customer)"}),"\n",(0,n.jsx)(t.li,{children:"Bearer Token (Provider)"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Action:"})," ",(0,n.jsx)(t.code,{children:"Shared\\Wallets\\DisplayAmountController"})]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"process-flow",children:"Process Flow"}),"\n",(0,n.jsx)(t.mermaid,{value:'graph TD\r\n    A["Start"] --\x3e B["Authenticated User Requests Wallet Details"];\r\n    B --\x3e C{"GET /api/v1/wallets"};\r\n    C --\x3e D["Instantiate DisplayAmountAction"];\r\n    D --\x3e E{"Determine User Type (Customer/Provider)"};\r\n    E -- "Customer" --\x3e F["Calculate Customer\'s Pending Amount"];\r\n    E -- "Provider" --\x3e G["Calculate Provider\'s Pending Amount"];\r\n    F --\x3e H["Get Wallet Balance"];\r\n    G --\x3e H;\r\n    H --\x3e I["Get Pending Withdrawal Requests"];\r\n    I --\x3e J["Calculate Total"];\r\n    J --\x3e K["Return Wallet Summary"];\r\n    K --\x3e L["End"];'}),"\n",(0,n.jsx)(t.h2,{id:"response-body",children:"Response Body"}),"\n",(0,n.jsx)(t.p,{children:"The response contains a detailed breakdown of the user's wallet."}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Field"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"amount"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"float"})}),(0,n.jsx)(t.td,{children:"The current available balance in the user's wallet."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"pending_amount"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"float"})}),(0,n.jsx)(t.td,{children:"The amount that is currently pending and not yet available in the wallet. See calculation logic below."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"withdrawal_requests"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"float"})}),(0,n.jsxs)(t.td,{children:["The total amount of withdrawal requests that are currently pending. See ",(0,n.jsx)(t.a,{href:"./withdrawal-requests",children:"Withdrawal Requests"})," for more."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"total"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"float"})}),(0,n.jsxs)(t.td,{children:["The total sum of ",(0,n.jsx)(t.code,{children:"amount"}),", ",(0,n.jsx)(t.code,{children:"pending_amount"}),", and ",(0,n.jsx)(t.code,{children:"withdrawal_requests"}),"."]})]})]})]}),"\n",(0,n.jsxs)(t.h3,{id:"success-response-200-ok",children:["Success Response (",(0,n.jsx)(t.code,{children:"200 OK"}),")"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\r\n    "status": "success",\r\n    "message": "Data has been retrieved successfully.",\r\n    "data": {\r\n        "amount": 1500.50,\r\n        "pending_amount": 250.00,\r\n        "withdrawal_requests": 500.00,\r\n        "total": 2250.50\r\n    }\r\n}\n'})}),"\n",(0,n.jsx)(t.h2,{id:"code-highlights--key-concepts",children:"Code Highlights & Key Concepts"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Unified Action, Role-Specific Logic:"})," The ",(0,n.jsx)(t.code,{children:"DisplayAmountAction"})," serves both Customers and Providers. Inside the action, it checks the ",(0,n.jsx)(t.code,{children:"last_login_type"})," of the authenticated user to determine which calculation logic to apply for the ",(0,n.jsx)(t.code,{children:"pending_amount"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Pending Amount Calculation (Customer):"})," For a Customer, the ",(0,n.jsx)(t.code,{children:"pending_amount"})," is the sum of the ",(0,n.jsx)(t.code,{children:"total_price"})," of all their orders that are not yet ",(0,n.jsx)(t.code,{children:"COMPLETED"})," and not ",(0,n.jsx)(t.code,{children:"cancelled"}),'. This represents money that is "on hold" for active orders.']}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Pending Amount Calculation (Provider):"})," For a Provider, the calculation is more complex. For each order that is not ",(0,n.jsx)(t.code,{children:"COMPLETED"})," and not ",(0,n.jsx)(t.code,{children:"cancelled"}),", the system calculates the provider's profit. This involves:","\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Calculating the platform's profit (20% of the order's ",(0,n.jsx)(t.code,{children:"total_price"}),")."]}),"\n",(0,n.jsx)(t.li,{children:"Calculating the tax on the platform's profit (15% of the profit)."}),"\n",(0,n.jsxs)(t.li,{children:["Subtracting the platform's profit and the tax from the order's ",(0,n.jsx)(t.code,{children:"total_price"})," to get the provider's net profit for that order.\r\nThe ",(0,n.jsx)(t.code,{children:"pending_amount"})," is the sum of these net profits from all active orders."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Withdrawal Requests:"})," The ",(0,n.jsx)(t.code,{children:"withdrawal_requests"})," value is the sum of all ",(0,n.jsx)(t.a,{href:"./withdrawal-requests",children:"Withdrawal Requests"})," for the user that have a ",(0,n.jsx)(t.code,{children:"PENDING"})," status. This gives the user a clear picture of how much money is in the process of being transferred out of their wallet."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"This concludes the documentation for the shared Wallet Management workflow."})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var s=r(6540);const n={},l=s.createContext(n);function i(e){const t=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);