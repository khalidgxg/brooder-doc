"use strict";(self.webpackChunkbrooder=self.webpackChunkbrooder||[]).push([[6862],{8453:(e,r,s)=>{s.d(r,{R:()=>o,x:()=>t});var i=s(6540);const n={},d=i.createContext(n);function o(e){const r=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(d.Provider,{value:r},e.children)}},9629:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"workflows/shared/reviews-management","title":"Review Management","description":"This workflow details how Customers can review completed orders and how Providers can reply to those reviews.","source":"@site/docs/workflows/shared/reviews-management.md","sourceDirName":"workflows/shared","slug":"/workflows/shared/reviews-management","permalink":"/brooder-doc/docs/workflows/shared/reviews-management","draft":false,"unlisted":false,"editUrl":"https://github.com/khalidgxg/brooder/tree/main/docs/workflows/shared/reviews-management.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Profile Management","permalink":"/brooder-doc/docs/workflows/shared/profile-management"},"next":{"title":"Service Management","permalink":"/brooder-doc/docs/workflows/shared/services-management"}}');var n=s(4848),d=s(8453);const o={sidebar_position:6},t="Review Management",l={},c=[{value:"Endpoints",id:"endpoints",level:2},{value:"Customer Endpoints",id:"customer-endpoints",level:3},{value:"Provider Endpoints",id:"provider-endpoints",level:3},{value:"Process Flows",id:"process-flows",level:2},{value:"Customer Creates a Review",id:"customer-creates-a-review",level:3},{value:"Provider Replies to a Review",id:"provider-replies-to-a-review",level:3},{value:"Request Bodies",id:"request-bodies",level:2},{value:"Create a Review (Customer)",id:"create-a-review-customer",level:3},{value:"Reply to a Review (Provider)",id:"reply-to-a-review-provider",level:3},{value:"Responses",id:"responses",level:2},{value:"Success Response (<code>200 OK</code>)",id:"success-response-200-ok",level:3},{value:"Logical Error Response (<code>409 Conflict</code>)",id:"logical-error-response-409-conflict",level:3},{value:"Code Highlights &amp; Key Concepts",id:"code-highlights--key-concepts",level:2}];function a(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"review-management",children:"Review Management"})}),"\n",(0,n.jsx)(r.p,{children:"This workflow details how Customers can review completed orders and how Providers can reply to those reviews."}),"\n",(0,n.jsx)(r.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,n.jsx)(r.h3,{id:"customer-endpoints",children:"Customer Endpoints"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Create a Review:"})," ",(0,n.jsx)(r.code,{children:"POST /api/v1/orders/{id}/reviews"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Allows a Customer to submit a review for a completed order. See the ",(0,n.jsx)(r.a,{href:"./orders-management",children:"Order Management"})," workflow for details on how an order reaches the ",(0,n.jsx)(r.code,{children:"COMPLETED"})," state."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"List Service Reviews:"})," ",(0,n.jsx)(r.code,{children:"GET /api/v1/services/{id}/reviews"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Fetches all reviews for a specific service."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"List Provider Reviews:"})," ",(0,n.jsx)(r.code,{children:"GET /api/v1/providers/{id}/reviews"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Fetches all reviews for a specific provider."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"provider-endpoints",children:"Provider Endpoints"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Reply to a Review:"})," ",(0,n.jsx)(r.code,{children:"POST /api/v1/reviews/{id}/reply"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Allows a Provider to post a public reply to a customer's review."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"List Own Reviews:"})," ",(0,n.jsx)(r.code,{children:"GET /api/v1/reviews"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Fetches all reviews written about the provider's services."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"List Service Reviews:"})," ",(0,n.jsx)(r.code,{children:"GET /api/v1/services/{id}/reviews"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Fetches all reviews for one of the provider's specific services."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"process-flows",children:"Process Flows"}),"\n",(0,n.jsx)(r.h3,{id:"customer-creates-a-review",children:"Customer Creates a Review"}),"\n",(0,n.jsx)(r.mermaid,{value:'graph TD\r\n    A["Start"] --\x3e B["Customer POSTs to /orders/{id}/reviews"];\r\n    B -- "with rate & content" --\x3e C["Validate Request"];\r\n    C -- "Validation Passes" --\x3e D{"Find Order by ID"};\r\n    D -- "Order Found" --\x3e E{"Is Order Status \'COMPLETED\'?"};\r\n    E -- "Yes" --\x3e F{"Has Order Already Been Reviewed?"};\r\n    F -- "No" --\x3e G["Create Review Record"];\r\n    G -- "Associated with Order, Service, Provider, and User" --\x3e H["Return Success Response"];\r\n    H --\x3e Z["End"];\r\n\r\n    D -- "Not Found" --\x3e I["Return 404 Not Found"];\r\n    E -- "No" --\x3e J["Return 404 Not Found"];\r\n    F -- "Yes" --\x3e K["Throw LogicalException (\'Already reviewed\')"];\r\n    I --\x3e Z;\r\n    J --\x3e Z;\r\n    K --\x3e Z;'}),"\n",(0,n.jsx)(r.h3,{id:"provider-replies-to-a-review",children:"Provider Replies to a Review"}),"\n",(0,n.jsx)(r.mermaid,{value:'graph TD\r\n    A["Start"] --\x3e B["Provider POSTs to /reviews/{id}/reply"];\r\n    B -- "with content" --\x3e C["Validate Request"];\r\n    C -- "Validation Passes" --\x3e D{"Find Review by ID for this Provider"};\r\n    D -- "Review Found" --\x3e E{"Does Review Already Have a Reply?"};\r\n    E -- "No" --\x3e F["Create Reply Record"];\r\n    F -- "Associated with Review and User" --\x3e G["Return Success Response"];\r\n    G --\x3e Z["End"];\r\n\r\n    D -- "Not Found" --\x3e H["Return 404 Not Found"];\r\n    E -- "Yes" --\x3e I["Throw LogicalException (\'Already replied\')"];\r\n    H --\x3e Z;\r\n    I --\x3e Z;'}),"\n",(0,n.jsx)(r.h2,{id:"request-bodies",children:"Request Bodies"}),"\n",(0,n.jsx)(r.h3,{id:"create-a-review-customer",children:"Create a Review (Customer)"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Field"}),(0,n.jsx)(r.th,{children:"Type"}),(0,n.jsx)(r.th,{children:"Description"}),(0,n.jsx)(r.th,{children:"Rules"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"rate"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"numeric"})}),(0,n.jsx)(r.td,{children:"The rating given, from 1 to 5."}),(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"required"}),", ",(0,n.jsx)(r.code,{children:"min:1"}),", ",(0,n.jsx)(r.code,{children:"max:5"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"content"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"string"})}),(0,n.jsx)(r.td,{children:"The text content of the review."}),(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"required"}),", ",(0,n.jsx)(r.code,{children:"min:2"}),", ",(0,n.jsx)(r.code,{children:"max:600"})]})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"reply-to-a-review-provider",children:"Reply to a Review (Provider)"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Field"}),(0,n.jsx)(r.th,{children:"Type"}),(0,n.jsx)(r.th,{children:"Description"}),(0,n.jsx)(r.th,{children:"Rules"})]})}),(0,n.jsx)(r.tbody,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"content"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"string"})}),(0,n.jsx)(r.td,{children:"The text content of the reply."}),(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"required"}),", ",(0,n.jsx)(r.code,{children:"min:2"}),", ",(0,n.jsx)(r.code,{children:"max:600"})]})]})})]}),"\n",(0,n.jsx)(r.h2,{id:"responses",children:"Responses"}),"\n",(0,n.jsxs)(r.h3,{id:"success-response-200-ok",children:["Success Response (",(0,n.jsx)(r.code,{children:"200 OK"}),")"]}),"\n",(0,n.jsx)(r.p,{children:"For creating a review:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-json",children:'{\r\n    "status": "success",\r\n    "message": "Data has been created successfully."\r\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"For replying to a review:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-json",children:'{\r\n    "status": "success",\r\n    "message": "Your reply has been added successfully."\r\n}\n'})}),"\n",(0,n.jsxs)(r.h3,{id:"logical-error-response-409-conflict",children:["Logical Error Response (",(0,n.jsx)(r.code,{children:"409 Conflict"}),")"]}),"\n",(0,n.jsx)(r.p,{children:"This is returned if a provider tries to reply to a review that already has a reply."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-json",children:'{\r\n    "status": "error",\r\n    "message": "You have already replied to this review."\r\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"code-highlights--key-concepts",children:"Code Highlights & Key Concepts"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Review Belongs to Order:"})," The system's design is robust because a review is directly tied to a completed order (",(0,n.jsx)(r.code,{children:"$order->review()->create(...)"}),"). This ensures that only customers who have actually completed a service can write a review, preventing fake or unverified feedback."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Single Review Guarantee:"})," Both the review creation (",(0,n.jsx)(r.code,{children:"$order->review()->exists()"}),") and reply (",(0,n.jsx)(r.code,{children:"$review->reply"}),") logic include checks to prevent duplicates. A customer can only review an order once, and a provider can only reply to a review once. This is enforced with ",(0,n.jsx)(r.code,{children:"LogicalException"}),"s, which provide clear error messages."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Contextual Authorization:"})," The ",(0,n.jsx)(r.code,{children:"ReplyToReviewAction"})," finds the review by chaining through the provider's own reviews (",(0,n.jsx)(r.code,{children:"$provider->reviews()->findOrFail($review_id)"}),"). This is an excellent security practice, as it ensures that a provider can only ever access (and reply to) reviews that belong to them, even if they try to guess other review IDs."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Middleware Protection:"})," The route for creating a review (",(0,n.jsx)(r.code,{children:"POST /orders/{id}/reviews"}),") is protected by the ",(0,n.jsx)(r.code,{children:"CheckOrderStatus"})," middleware. This middleware likely ensures that the order's status is appropriate (e.g., ",(0,n.jsx)(r.code,{children:"COMPLETED"}),") before even allowing the request to hit the controller, providing an early layer of validation."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"This concludes the documentation for all shared workflows."})]})}function h(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}}}]);